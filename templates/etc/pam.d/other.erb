<%
to_output = []

pam_types = [
  'auth',
  'account',
  'password',
  'session'
]

if @_warn_if_unknown then
  pam_types.each do |pam_type|
    to_output << "#{pam_type}    required    pam_warn.so"
  end
end

if @_deny_if_unknown then
  pam_types.each do |pam_type|
    to_output << "#{pam_type}    required    pam_deny.so"
  end
end
-%>
<%= to_output.join("\n") %>
